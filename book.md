# 关于本书

- [关于本书](#关于本书)
  - [作者简介](#作者简介)
  - [译者序](#译者序)
  - [推荐序](#推荐序)
  - [内容简介](#内容简介)
  - [本书结构](#本书结构)

## 作者简介

Chris Eagle从事逆向工程工作已有40年。他是《IDA Pro权威指南》的作者，以及非常受欢迎的逆向工程培训专家。他开发了许多逆向工程工具，并在Blackhat、Defcon和Shmoocon等会议上发表演讲。Kara Nance是一名私人安全顾问。多年来一直是计算机科学教授。她曾在Honeynet Project董事会任职，并在世界各地的会议上发表过多次演讲。她喜欢构建Ghidra扩展并定期提供Ghidra培训。

杨超，毕业于西安电子科技大学，L-Team成员，CISP，CISSP，《CTF竞赛权威指南(Pwn篇)》作者。目前就职于某头部造车新势力，从事车联网安全研究、攻防测试和工具开发工作，拥有多个CVE。活跃在开源社区，项目star数6000+。

## 译者序

Ghidra 第一次出现在公众视野是在 2017 年 3 月，当时维基解密开始泄露 Vault 7 文档，这是美国中央情报局（CIA）最大的机密文件泄漏事件，该文档包括各种秘密网络武器和间谍技术。其中，Vault 7 的第一部分包括恶意软件库、0day 武器化攻击，以及如何控制苹果的 iPhone、谷歌的 Android 和微软的 Windows 设备。和 Ghidra 相关的内容就位于这一部分，包括最新版本的软件和安装使用手册。

在 2019 年的 RSA 会议上，NSA 高级网络安全顾问 Rob Joyce 发表了 Get Your Free NSA Reverse Engineering Tool 的议题，解释了 Ghidra 的独特功能和特性，并发布了 Ghidra 二进制程序。最终，在当年的 4 月 4 日，NSA 在 GitHub 上公布了 Ghidra 源码。

很难说是不是当年的泄露事件导致了这一开源行为，但对于广大逆向工程师来说，确实获得了一个功能强大且免费的工具。没有哪个逆向工具是完美的，它们都有各自的优缺点，并且在竞争中相互取长补短。即使你已经掌握了 IDA Pro、Binary Ninja 或者 Radare2，也可以从 Ghidra 中受益。Ghidra 的主要优势有：开源且免费（这意味着有无限可能）；支持众多的处理器架构；允许在同一个项目中加载多个二进制文件，并同时进行相关操作；拥有设计强大且良好的 API，方便开发自动化
工具；支持团队协作模式；支持版本跟踪和匹配，等等。

本书的作者之一 Chris Eagle 是一位经验丰富的逆向工程专家，他早在十年前就出版了《IDA Pro权威指南》一书，到今天依然非常受欢迎，能有幸翻译他的这本新作让我备感荣幸。这两本书的结构大体相似，但在具体细节上有诸多不同，如果你已经熟练掌握了 IDA Pro，那么切换到 Ghidra 也相当容易。甚至可以将它们结合起来使用，在一个工具中集成另一个工具的能力——已有研究表明结合多个反汇编程序可以明显地提升函数识别率。

本书的出版，首先要感谢我的大学室友刘晋和我的应届生导师丁增贤，他们贡献了第 7 章、第 17 章和附录的初稿；感谢电子工业出版社的刘皎老师，给予我充分的信任和耐心，并花费许多时间和精力校正各类错误；感谢父母的关心和支持，你们是我人生道路上最坚实的后盾；感谢白玉的监督和陪伴，祝你在今后的日子里少点苦、多点甜，少生气、多开心。最后，再一次向读者推荐我的母校西安电子科技大学网络与信息安全学院，那里有最好的老师和同学! 

感谢读者购买此书。希望你们在探索 Ghidra 和逆向工程的道路上，能够享受到和我一样的乐趣。在翻译过程中，我努力将内容表述清楚，但限于英文水平和专业能力，译文中难免出现疏漏和错误，欢迎读者批评指正。

杨超
2022 年 10 月于北京

## 推荐序

2016 年，刘皎老师邀请我翻译 Jonathan Levin 的 Android Internals: Vol I，我毫不犹豫地答应了——主要是因为这本书好贵！而我既想读书，又不想花钱买……翻译这个活儿太适合我了，哈哈！可到 2017 年，出了 Vault 7 泄露事件，这本 Android Internals: Vol I 因为被 CIA“盗版”用于内部培训，也一并被泄露。结果 Levin 只好在自己的主页上公开了这本书——这下不花钱也能看了。（小丑竟是我自己？！）

受 Vault 7 事件影响而公开的并不仅是这本 Android Internals。Ghidra，一款由美国国家安全局（NSA）研发的逆向工程工具，原本只是内部使用的工具，也在这一事件中泄露，因此被迫公开。现在 Ghidra 已经开源，可以直接在 GitHub 上获得。

初识 Ghidra 时，我对它的感觉是非常惊艳！当时我正在做一些恶意软件变种分析的项目。由于 IDA pro 自身没有二进制可执行文件的比对功能，所以经常要用 BinDiff 这类第三方工具/插件。当有一个功能与 IDA 类似、但竟然能直接进行二进制代码比对的软件时，我的感触之深不言而喻。而且，Ghidra 竟然还是天生支持反编译的（与之对应，IDA 的反编译模块是需要花大价钱购买的），并且效果似乎确实不错！因此，我曾把玩过一段时间的 Ghidra，但当时只有软件自带的帮助文档，终究还是少了一盏指路的明灯，最终抵不过工期太紧，加上之前的工具已经用得很熟练了，渐渐只能暂时搁置了。

2020 年 8 月，The Ghidra Book: the Definitive Guide 一书出版了，而且 1~2 个月后就有了可以下载的电子版。我下载后迫不及待地开始阅读。显然，本书无论是书名、封面设计、还是内容，根本就是大名鼎鼎的 The IDA Pro Book 的 Ghidra 版！更何况，其主要作者正是 The IDA Pro Book 的作者 Chris Eagle！

本书内容由浅入深，循序渐进——从最基本的软件安装到图形界面操作、再从进阶到编写自己的分析脚本和处理器模块，最后竟然还有 IDA Pro 用户（比如我）如何转向 Ghidra 的建议！因此，不论是新手上路，还是逆向老手，都能从中获益匪浅。书中同时提供配套代码，使读者能够自己动手完成对应的操作，确实是一本又说又练的“真把式”好书。读完之后，我就向刘皎老师推荐了这本书，希望引进出版。

软件逆向工程工具本就不多，特别是在软件静态分析工具方面，Ghidra 是少数能与 IDA Pro 比肩的软件。这一点不论是从它在 GitHub 上的星数，或者 “Ghidra”的百度搜索结果上都能看出来。古人云：“工欲善其事，必先利其器”。自从 2015 年“网络空间安全”正式成为“工学”门类下的一级学科后，国内网络安全相关研究和竞赛赛事蓬勃发展。不论是网络安全研究人员、相关专业的学生，还是爱好者都应该熟练掌握相关工具，然后方能在此基础上，事半功倍地发挥自己的聪明才智，
做出自己的贡献。

本书译者是《CTF 竞赛权威指南（pwn 篇）》的作者杨超，他长期从事车联网安全研究和工具开发工作，拥有非常丰富的实践经验。本书译文精美、表达流畅、术语翻译精准，个人认为达到了“信达雅”的境界。中文版的面世，能为广大学子和从业人员掌握和熟练使用 Ghidra 提供有益的指导。相信有志学习者，经过认真钻研，必能早日登堂入室，为我国网络安全事业的发展添砖加瓦！

崔孝晨
Team 509 成员
《Python 绝技：运用 Python 成为顶级黑客》译者

## 内容简介

Ghidra是美国国家安全局（NSA）开发的免费和开源的逆向工程工具，已于2019年的RSA正式发布，包含了一整套功能齐全的高级软件分析工具，可以帮助广大研究人员在Windows、macOS和Linux各大常见系统平台上进行源代码分析。目前已在技术安全社区掀起一股学习热潮。

## 本书结构

- 第1章 反汇编简介
- 第2章 逆向与反汇编工具
- 第3章 初识Ghidra
- 第4章 开始使用Ghidra
- 第5章 Ghidra数据显示
- 第6章 理解Ghidra反汇编
- 第7章 反汇编操作
- 第8章 数据类型和数据结构
- 第9章 交叉引用
- 第10章 图形
- 第11章 协作逆向工程
- 第12章 自定义Ghidra
- 第13章 Ghidra功能扩展
- 第14章 Ghidra脚本开发
- 第15章 Eclipse和GhidraDev
- 第16章 Ghidra无头模式
- 第17章 Ghidra加载器
- 第18章 Ghidra处理器
- 第19章 Ghidra反编译器
- 第20章 编译器变体
- 第21章 混淆代码分析
- 第22章 修补二进制文件
- 第23章 二进制差分和版本跟踪
- 附录A IDA用户的Ghidra使用指南
